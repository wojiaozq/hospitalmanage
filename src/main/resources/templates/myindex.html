<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="renderer" content="webkit">
  		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>网站后台管理模版</title>
		<link rel="stylesheet" type="text/css" href="./static/admin/layui/css/layui.css"/>
		<link rel="stylesheet" type="text/css" href="./static/admin/css/admin.css"/>

	</head>
	<body>
		<div class="main-layout" id='main-layout'>
			<!--侧边栏-->
			<div class="main-layout-side">
				<div class="m-logo">
				</div>
				<ul id="treeMenu" class="layui-nav layui-nav-tree" lay-filter="leftNav">

				</ul>
			</div>
			<!--右侧内容-->
			<div class="main-layout-container">
				<!--头部-->
				<div class="main-layout-header">
					<div class="menu-btn" id="hideBtn">
						<a href="javascript:;">
							<span class="iconfont">&#xe60e;</span>
						</a>
					</div>
					<ul class="layui-nav" lay-filter="rightNav">
					  <li class="layui-nav-item"><a href="javascript:;" data-url="email.html" data-id='15' data-text="邮件系统"><i class="iconfont">&#xe603;</i></a></li>
					  <li class="layui-nav-item">
					    <a href="javascript:;" data-url="admin-info.html" data-id='16' data-text="个人信息">小朱</a>
					  </li>
					  <li class="layui-nav-item"><a href="javascript:;">退出</a></li>
					</ul>
				</div>
				<!--主体内容-->
				<div class="main-layout-body">
					<!--tab 切换-->
					<div class="layui-tab layui-tab-brief main-layout-tab" lay-filter="tab" lay-allowClose="true">
					  <ul class="layui-tab-title">
					    <li class="layui-this welcome">个人中心</li>
					  </ul>
					  <div class="layui-tab-content">
					    <div class="layui-tab-item layui-show" style="background: #f5f5f5;">
					    	<!--1-->
					    	<iframe id="mainIframe" src="" width="100%" height="100%" name="iframe" scrolling="auto" class="iframe" framborder="0"></iframe>
					    	<!--1end-->
					    </div>
					  </div>
					</div>
				</div>
			</div>
			<!--遮罩-->
			<div class="main-mask">

			</div>
		</div>
		<script type="text/javascript">
			var scope={
				link:'./welcome.html'
			}
		</script>
		<script src="./static/admin/layui/layui.js" type="text/javascript" charset="utf-8"></script>
		<script src="./static/admin/js/common.js" type="text/javascript" charset="utf-8"></script>
		<script src="./static/admin/js/main.js" type="text/javascript" charset="utf-8"></script>
	</body>
</html>

<script type="application/javascript">
    function getHttp(){
        var xmlhttp;
        if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp=new XMLHttpRequest();
        }
        else {// code for IE6, IE5
            xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
        }
        return xmlhttp;
    }
     // window.onload
     window.onpageshow = function () {
        //使用ajax函数
        var xmlhttp = getHttp();
        xmlhttp.onreadystatechange=function() {
            if (xmlhttp.readyState==4 && xmlhttp.status==200) {
                // console.log(10);
                // var a = xmlhttp.responseText;
                // alert(xmlhttp.responseText);
                var menu = document.getElementById("treeMenu");
                var str = "<li class=\"layui-nav-item\"><a href=\""+"myindex.html"+"\" data-text=\"首页\"><i class=\"iconfont\">&#xe60e;</i>首页</a>\n" +
                    " </li>";
                var liStrat = "<li class=\"layui-nav-item\"> <a href=\"javascript:;\" onclick='gotoFuc(this);' data-url=\"";
                var liMid1_1 = "\" data-id='";
                var liMid1_2 = "' data-text=\"";
                var liMdi2 = "\"><i class=\"iconfont\">&#xe606;</i>";
                var liaEnd = "</a>";
                var ddStrt0 = "<ul class=\"layui-nav-child\">";
                var ddStart = "  <li class=\"layui-nav-item\"><a href=\"javascript:;\" data-url=\"";//+url
                var ddMid1 = "\" data-id='";//+data-id
                var ddMid2 = "' data-text=\"";//+name
                var ddMid3 = "\"><span class=\"l-line\"></span>";//+name
                var ddEnd = "</a></li>";
                var liEnd ="</li>";
                var str = xmlhttp.responseText.split('\n');
                if(str[0] == "root"){
                    var main = document.getElementById("mainIframe").setAttribute("src","welcome.html");
				}
                if(str[0] == "医生"){
                    var main = document.getElementById("mainIframe").setAttribute("src","welcome_doctor.html");
                }
                var value = eval('('+str[1]+')');
                var count = 1;
                for (var i = 0; i < value.length; i++) {
                     // console.log(value[i].url);
                    if(value[i].pid == 0){
                        if(value[i].url==null || value[i].url == ""){
                            str += "<li class=\"layui-nav-item\"> <a href=\"javascript:;\"><i class=\"iconfont\">&#xe607;</i>"+value[i].name+liaEnd;
                        }else{
                            str += liStrat+value[i].url+liMid1_1+count+liMid1_2+value[i].name+liMdi2+value[i].name+liaEnd;
                        }
                        ++count;
                        var c = count;
                        var next = "";//拼接二级菜单
                        next += ddStrt0;
                        // str +=ddStrt0;
                        for(var j = 0;j<value.length;++j){
                            if(value[i].id == value[j].pid){
                                next += ddStart+value[j].url+ddMid1+count+ddMid2+value[j].name+ddMid3+value[j].name+ddEnd;
                                ++count;
                            }
                        }
                        if(c != count){
                            next += " </ul>";
                            str += next;
                        }

                        str += liEnd;
                    }
                }
                // console.log(str);
                menu.innerHTML="";
                menu.innerHTML=str;
            }
        }
        xmlhttp.open("GET","getMenu",true);
        xmlhttp.send();
    }
    function  gotoFuc(value) {
        // console.log(value);
        // alert(value.getAttribute("data-url"));
        // console.log(value.data-url);
        var main = document.getElementById("mainIframe");
        // console.log(main);
        // alert(main.getAttribute("src"));
        main.setAttribute("src",value.getAttribute("data-url")+"");

		// alert(value);
    }
</script>

